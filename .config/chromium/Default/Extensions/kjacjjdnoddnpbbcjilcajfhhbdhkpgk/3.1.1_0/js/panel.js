var wheelFlag=false;(function(){"use strict";var bgpage=chrome.extension.getBackgroundPage();function init(){setText("main_settings_tooltip",chrome.i18n.getMessage("main_settings_tooltip"));setText("main_add_blacklist_tooltip",chrome.i18n.getMessage("main_add_blacklist_tooltip"));setText("finish-message-for-user",chrome.i18n.getMessage("main_grown_popup_user_reward_pre"));setText("finish-message-for-guest-text-pre",chrome.i18n.getMessage("main_grown_popup_guest_info_pre"));setText("finish-message-for-guest-link",chrome.i18n.getMessage("main_grown_popup_guest_info_link"));setText("finish-message-for-guest-text-post",chrome.i18n.getMessage("main_grown_popup_guest_info_post"));setText("do-not-show-finish-message-text",chrome.i18n.getMessage("main_grown_popup_guest_do_not_show_again"));bgpage.updateUI();chrome.tabs.query({active:true,lastFocusedWindow:true},function(tabs){var tab=tabs[0];if(bgpage.isBlacklisted(tab)){addClass(document.getElementById("add-to-blacklist-icon"),"hidden")}});document.getElementById("finish-message-for-guest-link").addEventListener("click",function(event){ga("send","event","finish-message-for-guest-link-clicked","clicked","guest")},false)}window.addEventListener("click",function(event){var t=event.target;if(t.id=="treeball"||t.id=="plant-board"||t.id=="plant-board-text"||t.id=="seed"||t.id=="tree"){bgpage.startTimer()}if(hasClass(t,"share-icon")){bgpage.clickShareButton(t.id)}if(t.id=="add-to-blacklist-icon"&&hasClass(t,"buttons")){chrome.tabs.query({active:true,lastFocusedWindow:true},function(tabs){var tab=tabs[0];var parserA=document.createElement("a");parserA.href=tab.url;var host=parserA.hostname;if(host!=null){chrome.storage.local.get({blackList:bgpage.getDefaultBlacklist()},function(items){var blacklist=items.blackList;for(var idx in blacklist){if(blacklist[idx].indexOf(host)>=0){return}}blacklist.splice(0,0,host);bgpage.setBlacklist(blacklist);chrome.storage.local.set({blackList:blacklist},function(){})})}});var atbIcon=document.getElementById("add-to-blacklist-icon");removeClass(atbIcon,"buttons");setTimeout(function(){addClass(atbIcon,"convergeToPoint");setTimeout(function(){addClass(atbIcon,"checked");removeClass(atbIcon,"convergeToPoint");setTimeout(function(){addClass(atbIcon,"convergeToPoint");setTimeout(function(){addClass(atbIcon,"hidden");removeClass(atbIcon,"checked");removeClass(atbIcon,"convergeToPoint");addClass(atbIcon,"buttons")},200)},500)},200)},100);chrome.storage.local.get({user:null},function(items){var user=items.user;ga("send","event","add-to-blacklist","clicked",user!=null?"user":"guest")})}if(t.id=="setting-icon"){removeClass(document.getElementById("setting-mask"),"disappear");setTimeout(function(){chrome.runtime.openOptionsPage(null)},100)}if(t.id=="timer-left-arrow"){bgpage.adjustPlantTime(1);chrome.storage.local.get({user:null},function(items){var user=items.user;ga("send","event","timer-arrow-clicked","clicked left",user!=null?"user":"guest")})}if(t.id=="timer-right-arrow"){bgpage.adjustPlantTime(-1);chrome.storage.local.get({user:null},function(items){var user=items.user;ga("send","event","timer-arrow-clicked","clicked right",user!=null?"user":"guest")})}if(t.id=="treeball-left-arrow"){bgpage.adjustTreeType(1);chrome.storage.local.get({user:null},function(items){var user=items.user;ga("send","event","treetype-arrow-clicked","clicked left",user!=null?"user":"guest")})}if(t.id=="treeball-right-arrow"){bgpage.adjustTreeType(-1);chrome.storage.local.get({user:null},function(items){var user=items.user;ga("send","event","treetype-arrow-clicked","clicked right",user!=null?"user":"guest")})}if(t.id=="confirm-btn"){var doNotShowFinishMessageForGuest=document.getElementById("do-not-show-finish-message").checked;bgpage.onClickFinishConfirmedButton(doNotShowFinishMessageForGuest)}},false);window.addEventListener("wheel",function(event){if(event.target.id=="treeball"||event.target.id=="plant-board"||event.target.id=="plant-board-text"){return}if(wheelFlag){return}wheelFlag=true;setTimeout(function(){wheelFlag=false},50);var delta=event.deltaY>0?1:event.deltaY<0?-1:0;bgpage.adjustPlantTime(delta)},false);window.addEventListener("contextmenu",function(event){event.preventDefault();return false},true);window.onload=init;(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga");ga("create","UA-76810879-1","auto");ga("set","checkProtocolTask",function(){});ga("send","pageview","/panel.html")})();